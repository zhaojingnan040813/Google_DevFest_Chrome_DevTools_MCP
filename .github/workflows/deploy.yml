# GitHub Actions å·¥ä½œæµ - è‡ªåŠ¨éƒ¨ç½² DevFest Workshop ç½‘ç«™
# ä½œè€…: èµµæ™¯å—
# åŠŸèƒ½: ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œç¡®ä¿é™æ€ç½‘ç«™å¿«é€Ÿä¸Šçº¿

name: Deploy DevFest Workshop Website

# è§¦å‘æ¡ä»¶
on:
  # å½“æ¨é€åˆ° main åˆ†æ”¯æ—¶è§¦å‘
  push:
    branches: [ main ]
  
  # å…è®¸æ‰‹åŠ¨è§¦å‘å·¥ä½œæµ
  workflow_dispatch:

# è®¾ç½®æƒé™
permissions:
  contents: read
  pages: write
  id-token: write

# å¹¶å‘æ§åˆ¶ - ç¡®ä¿åŒæ—¶åªæœ‰ä¸€ä¸ªéƒ¨ç½²åœ¨è¿è¡Œ
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # æ„å»ºå’Œéƒ¨ç½²ä½œä¸š
  deploy:
    name: æ„å»ºå¹¶éƒ¨ç½²ç½‘ç«™
    runs-on: ubuntu-latest
    
    steps:
    # æ£€å‡ºä»£ç 
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
    
    # å‡†å¤‡é™æ€æ–‡ä»¶
    - name: å‡†å¤‡é™æ€æ–‡ä»¶
      run: |
        echo "å‡†å¤‡éƒ¨ç½²æ–‡ä»¶..."
        ls -la
        echo "âœ… é™æ€æ–‡ä»¶å‡†å¤‡å®Œæˆ"
    
    # ä¸Šä¼ æ„å»ºäº§ç‰©
    - name: ä¸Šä¼ æ„å»ºäº§ç‰©
      uses: actions/upload-pages-artifact@v3
      with:
        path: '.'
    
    # éƒ¨ç½²åˆ° GitHub Pages
    - name: éƒ¨ç½²åˆ° GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4
      with:
        token: ${{ github.token }}
      
    # éƒ¨ç½²æˆåŠŸé€šçŸ¥
    - name: éƒ¨ç½²æˆåŠŸé€šçŸ¥
      run: |
        echo "ğŸ‰ DevFest Workshop ç½‘ç«™éƒ¨ç½²æˆåŠŸï¼"
        echo "ğŸ“± ç½‘ç«™åœ°å€: ${{ steps.deployment.outputs.page_url }}"
        echo "ğŸš€ éƒ¨ç½²æ—¶é—´: $(date)"